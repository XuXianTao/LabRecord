<div class="container home-course">
  <div class="home-course__import">
  </div>
  <table class="table table-hover" id="table-course"></table>
  <div id="info_course"></div>
</div>
<script>
var tableBox_course = $('#table-course');
var render_time3 = 0;
$(document).ready(function() {
  tableBox_course.bootstrapTable({
    height: 350,
    striped: true, // 隔行变色
    method: 'post',
    url: "{:Url('Table/table_course')}",
    dataType: 'json',
    search: true, // 启用搜索框
    showHeader: true,
    pagination: true, //在表格底部显示分页工具栏
    onlyInfoPagination: true,
    pageSize: 1000,
    columns: [{
        field: 'cid',
        title: '课程编号',
        sortable: true,
        align: 'center',
      },
      {
        field: 'cname',
        title: '课程名',
        sortable: true,
        align: 'center',
      },
      {
        field: 'cla',
        title: '教室',
        sortable: true,
        align: 'center',
      },
      {
        field: 'teacher.name',
        title: '任课教师',
        sortable: true,
        align: 'center',
      },
      {
        field: 'sch_time',
        title: '上课时间',
        sortable: true,
        align: 'center',
      },
      {
      	field: 'sch_year',
      	title: '学年',
      	sortable: true,
      	align: 'center',
      },
      {
      	field: 'sch_term',
      	title: '学期',
      	sortable: true,
      	align: 'center',
      },
      {
      	field: 'action',
      	title: '操作',
      	sortable: true,
      	align: 'center',
        formatter: actionFormatter_course,
      }
    ],
  });
});
$(document).click(function() {
  tableBox_course.bootstrapTable('resetView');
})

function actionFormatter_course(value, row, index) {
  var id = row['cid'];
  var result = "<a href='javascript:;' class='btn btn-warning table-btn' onclick=\"delete_course('" + id + "','" + index + "')\" title='删除'><span>删除</span></a>";
  return result;
}

function delete_course(id, index) {
  if (confirm("确定要清空数据？对应的学生信息也将清空！"))
  $.post({
    url: '{:Url("Table/delete_course")}',
    data: { 'id': id },
    success: function(data) {
      $("#info_course").html(id + '状态修改成功');
      console.log(data);
      tableBox_course.bootstrapTable('remove',
      	{ field: 'action',
      	  value: [id]
      	});
    },
    error: function() {
      $("#info_course").html(id + '状态修改失败');
    }
  })
}
</script>